# Configuration to make the SECOM only use the SEM part.
SECOM: {
    class: Microscope,
    role: sem,
    emitters: ["EBeam ExtXY"],
    detectors: ["SED ExtXY", "BSD ExtXY"],
    actuators: ["Redstone Stage"],
}

# Quanta SEM driven via external X/Y connection, using a DAQ board
"Quanta ExtXY": {
    class: semcomedi.SEMComedi,
    role: none,
    init: {device: "/dev/comedi0"},
    # more detectors can be added, if necessary
    children: {scanner: "EBeam ExtXY", detector0: "SED ExtXY", detector1: "BSD ExtXY"}
}

# Connect:
# X -> AO 0
# Y -> AO 1
# Ground -> AO GND
"EBeam ExtXY": {
    # Internal child of Quanta ExtXY, so no class
    role: e-beam,
    init: {
        channels: [0, 1],
        limits: [[0, 5], [0, 5]],  # V
        settle_time: 10.e-6, # s
        hfw_nomag: 10.e-3, # m
    },
    properties: {
        resolution: [512, 512], # px
        dwellTime: 10.e-6, # s
        magnification: 1000, # (ratio)
    },
    affects: ["SEM ExtXY"] # affects the CCD in case of cathodoluminescence
}

# Must be connected on AI 5/AI GND
"SED ExtXY": { # aka ETD
    # Internal child of Quanta ExtXY, so no class
    role: se-detector,
    init: {
        channel: 5,
        limits: [-3, 3] # V
    },
}

# Must be connected on AI 6/AI GND
"BSD ExtXY": { # aka Backscatter
    # Internal child of Quanta ExtXY, so no class
    role: bs-detector,
    init: {
        channel: 6,
        limits: [-3, 3] # V
    },
}

# PI RedStone jumpers (.=off):
# X,Y = 1234...8
# X => Ch1
# Y => Ch2
# Axes should be synchronized with the camera
"Redstone Stage": {
    class: pi.StageRedStone,
    role: stage,
    affects: ["EBeam ExtXY"],
    init: {
        port: /dev/ttyS0, # serial port on the board
        # port: /dev/ttyPIRS, # USB serial port
        axes: {x: [0, 1], y: [0, 0]}, # axis -> controller, channel
        inverted: ["y"],
    }, 
    properties: {
        speed: {'x': 0.001, 'y': 0.001} #m/s
    }
}
